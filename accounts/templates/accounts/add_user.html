{% extends "accounts/layout.html" %}

{% block title %}Add User{% endblock %}

{% block content %}
<div class="form-card">
    <h2 class="form-title">âž• Add New User</h2>

    {% if error %}
        <div class="alert error">{{ error }}</div>
    {% endif %}

    <form method="post" class="styled-form">
        {% csrf_token %}

        <div class="form-group">
            <label>Username</label>
            <input type="text" name="username" value="{{ request.POST.username }}" required>
        </div>

        <div class="form-group">
            <label>Email</label>
            <input type="email" name="email" value="{{ request.POST.email }}" required>
        </div>

        <div class="form-group">
            <label>Password</label>
            <input type="password" name="password1" required>
        </div>

        <div class="form-group">
            <label>Confirm Password</label>
            <input type="password" name="password2" required>
        </div>

        <div class="form-group">
            <label>Role</label>
            <select name="role" required>
                <option value="cashier" {% if request.POST.role == "cashier" %}selected{% endif %}>Cashier</option>
                <option value="manager" {% if request.POST.role == "manager" %}selected{% endif %}>Manager</option>
                {% if user.is_superuser %}
                <option value="admin" {% if request.POST.role == "admin" %}selected{% endif %}>Admin</option>
                {% endif %}
            </select>
        </div>

        {% if user.is_superuser %}
        <div class="form-group">
            <label>Branch</label>
            <select name="branch" required>
                {% for branch in branches %}
                    <option value="{{ branch.id }}" {% if request.POST.branch == branch.id|stringformat:"s" %}selected{% endif %}>{{ branch.name }}</option>
                {% endfor %}
            </select>
        </div>
        {% endif %}

        <div class="form-actions">
            <button type="submit" class="btn-primary">Add User</button>
            <button type="button" class="btn btn-secondary" onclick="window.location.href='{% url 'accounts:manage_users' %}'">
                Cancel
            </button>
        </div>
    </form>
</div>
{% endblock %}
